<div class="flex justify-center">
  <%= form_with model: post, local: true do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="form-group">
      <%= f.label :date %>
      <%= f.date_field :date, class: 'form-control', rows: 10 %>
    </div>
    <div class="form-group">
      <%= f.label :body %>
      <%= f.text_area :body, class: 'form-control', rows: 10 %>
    </div>
    <div class="form-group">
      <%= f.label :image %>
      <%= f.file_field :image, class: 'form-control mb-3', accept: 'image/*', id: :post_img %>
      <%= f.hidden_field :image_cache %>
    </div>
    <div class='mt-3 mb-3'>
      <% if post.image? %>
        <%= image_tag post.image.url, id: 'img_prev', size: '100x100' %>
      <% end %>
    </div>

    <script type="text/javascript">
      $(function() {
        function readURL(input) {
            if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
        $('#img_prev').attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
            }
        }
        $("#post_img").change(function(){
            readURL(this);
        });
      });
    </script>

    <%= f.submit t('defaults.create'), class: 'btn btn-primary' %>
  <% end %>
</div>